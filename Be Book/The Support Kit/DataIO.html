<HTML><HEAD><TITLE>The Support Kit: BDataIO and BPositionIO</TITLE></HEAD><BODY BGCOLOR=#ffffff>


<!--TOP LINKS-->
<HR>
<center>
<TABLE bgcolor=ddeeee>
<TR><TD>
<A HREF="index.html"><FONT face=HELVETICA>The Support Kit Table of Contents</FONT></A>&nbsp;&nbsp;
<TD>
&nbsp;&nbsp;<A HREF="The%20Support%20Kit%20Master%20Index.html"><FONT face=HELVETICA>The Support Kit Index</FONT></A>
</TABLE></center>
<!--TOP LINKS-->


<HR>
<H1>
<A NAME="BDataIO%20and%20BPositionIO"></A>BDataIO and BPositionIO
</H1>
<P>
Derived from:  BDataIO: 
<br>
<P>
Declared in:  <A HREF="/boot/develop/headers/be/support/DataIO.h">be/support/DataIO.h</A>
<P>
Library:  libbe.so
<P>
<H6><A HREF="DataIO and BPositionIO.summary.html"><i>Summary</i></A></H6>
<P>
BDataIO and BPositionIO are abstract classes defining protocols for performing input/output operations.  Classes derived from them represent the various objects that can be treated as sources of input data or as repositories for output data.  For example, the <A HREF="../The%20Storage%20Kit/File.html#BFile">BFile</A> class, defined in the Storage Kit, represents a file.  BMallocIO and BMemoryIO, also defined in the Support Kit, represent dynamically allocated memory buffers.
<P>
BDataIO declares only the basic I/O functions <B><TT><A HREF="#Read()">Read()</A></TT></B> and <B><TT><A HREF="#Write()">Write()</A></TT></B>.  BPositionIO declares an additional set of functions (<B><TT><A HREF="#ReadAt()">ReadAt()</A></TT></B>, <B><TT><A HREF="#WriteAt()">WriteAt()</A></TT></B>, <B><TT><A HREF="#Seek()">Seek()</A></TT></B>, and <B><TT><A HREF="#Position()">Position()</A></TT></B>) for objects that can keep track of the current position in the I/O buffer; it implements <B><TT><A HREF="#Read()">Read()</A></TT></B> and <B><TT><A HREF="#Write()">Write()</A></TT></B> in terms of these other functions.
<P>
Neither class declares any data members, nor do they implement the functions in the protocols they declare.  It's up to derived classes to implement them based on the properties of the particular kinds of data sources/repositories they represent. 
<P>
<HR>
<H2>
<A NAME="Constructor%20and%20Destructor"></A><FONT SIZE=6>C</FONT>onstructor and <FONT SIZE=6>D</FONT>estructor
</H2>
<P>
<HR>
<H3>
<A NAME="BDataIO()"></A>BDataIO()
, 
<A NAME="BPositionIO()"></A>BPositionIO()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
<B><TT><FONT  color=000022 size=+1>BDataIO(</TT></B></FONT>void<B><TT><FONT  color=000022 size=+1>)</TT></B></FONT> 
<P>


<TR><TD>
<B><TT><FONT  color=000022 size=+1>BPositionIO(</TT></B></FONT>void<B><TT><FONT  color=000022 size=+1>)</TT></B></FONT> 
<P>

</TABLE></TABLE>

<P>
These constructors have nothing to do.  Constructors in derived classes should initialize the object to default values&mdash;for example, set the current position to the beginning of the data.
<P>
<HR>
<H3>
<A NAME="~BDataIO()"></A>~BDataIO()
, 
<A NAME="~BPositionIO()"></A>~BPositionIO()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
virtual <B><TT><FONT  color=000022 size=+1>~BDataIO()</TT></B></FONT> 
<P>


<TR><TD>
virtual <B><TT><FONT  color=000022 size=+1>~BPositionIO()</TT></B></FONT> 
<P>

</TABLE></TABLE>

<P>
These destructors do nothing.
<P>
<HR>
<H2>
<A NAME="Member%20Functions"></A><FONT SIZE=6>M</FONT>ember <FONT SIZE=6>F</FONT>unctions
</H2>
<P>
<HR>
<H3>Position()   see <A HREF="#Seek()">Seek()</A></H3>
<P>
<HR>
<H3>
<A NAME="Read()"></A>Read()
, 
<A NAME="ReadAt()"></A>ReadAt()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>Read(</TT></B></FONT>void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;=&nbsp;0
<P>

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>Read(</TT></B></FONT>void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)
<P>
</TT></B></FONT>

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>ReadAt(</TT></B></FONT>off_t&nbsp;<I><FONT  color=991122 face=HELVETICA>position</I></FONT>, void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;=&nbsp;0
<P>

</TABLE></TABLE>

<P>
<B><TT><A HREF="#Read()">Read()</A></TT></B> is implemented by derived classes to copy <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT> bytes of data from the object to the <I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>.  It should return the number of bytes actually read, which may be 0, or an error code if something goes wrong.
<P>
Similarly, <B><TT><A HREF="#ReadAt()">ReadAt()</A></TT></B> is implemented by derived classes to read <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT> bytes of data beginning at <I><FONT  color=991122 face=HELVETICA>position</I></FONT> in the data source, and to place them in the <I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>.  Like <B><TT><A HREF="#Read()">Read()</A></TT></B>, it should return the number of bytes actually read, or an error code if something goes wrong.
<P>
The BPositionIO class implements <B><TT><A HREF="#Read()">Read()</A></TT></B> in terms of <B><TT><A HREF="#ReadAt()">ReadAt()</A></TT></B>, <B><TT><A HREF="#Seek()">Seek()</A></TT></B>, and <B><TT><A HREF="#Position()">Position()</A></TT></B>&mdash;so that it will always read starting at the current position and move the current position beyond the data it has read.  However, it leaves these latter functions for derived classes to implement.
<P>
<HR>
<H3>
<A NAME="Seek()"></A>Seek()
, 
<A NAME="Position()"></A>Position()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
virtual off_t <B><TT><FONT  color=000022 size=+1>Seek(</TT></B></FONT>off_t <I><FONT  color=991122 face=HELVETICA>position</I></FONT>, int32 <I><FONT  color=991122 face=HELVETICA>mode</I></FONT><B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;=&nbsp;0
<P>


<TR><TD>
virtual off_t <B><TT><FONT  color=000022 size=+1>Position(</TT></B></FONT>void<B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;const&nbsp;=&nbsp;0
<P>

</TABLE></TABLE>

<P>
<B><TT>Seek()</TT></B> is implemented by derived classes to modify the current position maintained by the object.  The current position is an offset in bytes from the beginning of the object's data.  How the <I><FONT  color=991122 face=HELVETICA>position</I></FONT> argument is interpreted will depend on the <I><FONT  color=991122 face=HELVETICA>mode</I></FONT> flag.  Three possible modes should be supported:
<P>
<UL>
<LI><B><TT>SEEK_SET</TT></B>.  The <I><FONT  color=991122 face=HELVETICA>position</I></FONT> passed is an offset from the beginning of allocated memory; in other words, the current position should be set to <I><FONT  color=991122 face=HELVETICA>position</I></FONT>.
<P>
<LI><B><TT>SEEK_CUR</TT></B>.  The <I><FONT  color=991122 face=HELVETICA>position</I></FONT> argument is an offset from the current position; the current position should be incremented by <I><FONT  color=991122 face=HELVETICA>position</I></FONT>.
<P>
<LI><B><TT>SEEK_END</TT></B>.  The <I><FONT  color=991122 face=HELVETICA>position</I></FONT> argument is an offset from the end of the data; the current position should be the sum of <I><FONT  color=991122 face=HELVETICA>position</I></FONT> plus the number of bytes in the data.
<P>
</UL>
<P>
For the <B><TT>SEEK_SET</TT></B> mode, <I><FONT  color=991122 face=HELVETICA>position</I></FONT> should be a positive value.  The other modes permit negative offsets.
<P>
<B><TT><A HREF="#Seek()">Seek()</A></TT></B> should return the new current position, as should <B><TT><A HREF="#Position()">Position()</A></TT></B>.
<P>
<HR>
<H3>
<A NAME="SetSize()"></A>SetSize()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
virtual status_t <B><TT><FONT  color=000022 size=+1>SetSize(</TT></B></FONT>off_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)
<P>
</TT></B></FONT>
</TABLE></TABLE>

<P>
Returns <B><TT><A HREF="ErrorCodes.html#B_ERROR">B_ERROR</A></TT></B> to indicate that, in general, BPositionIO objects can't set the amount of memory in the repositories they represent.  However, the BMallocIO class in this kit and <A HREF="../The%20Storage%20Kit/File.html#BFile">BFile</A> in the Storage Kit implement <B><TT><A HREF="#SetSize()">SetSize()</A></TT></B> functions that override this default.
<P>
<B>See also:  <TT><A HREF="../The%20Storage%20Kit/File.html#SetSize()">BFile::SetSize()</A></TT></B>, <B><TT>BMallocIO::SetSize()</TT></B> 
<P>
<HR>
<H3>
<A NAME="Write()"></A>Write()
, 
<A NAME="WriteAt()"></A>WriteAt()
</H3>
<P>

<Table>
<TR> 
<TD>&nbsp;&nbsp;
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TR> 
<TD>&nbsp;&nbsp;
<TD><p><Table cellpadding =3 bgcolor =eeeeee> 

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>Write(</TT></B></FONT>const void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;=&nbsp;0
<P>

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>Write(</TT></B></FONT>const void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)
<P>
</TT></B></FONT>

<TR><TD>
virtual ssize_t <B><TT><FONT  color=000022 size=+1>WriteAt(</TT></B></FONT>off_t&nbsp;<I><FONT  color=991122 face=HELVETICA>position</I></FONT>, const void *<I><FONT  color=991122 face=HELVETICA>buffer</I></FONT>, size_t <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT><B><TT><FONT  color=000022 size=+1>)</TT></B></FONT>&nbsp;=&nbsp;0
<P>

</TABLE></TABLE>

<P>
<B><TT><A HREF="#Write()">Write()</A></TT></B> is implemented by derived classes to copy <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT> bytes of data from the <I><FONT  color=991122 face=HELVETICA>buffer</I></FONT> to the object.  It should return the number of bytes actually written, which may be 0, or an error code if the operation fails.
<P>
Similarly, <B><TT><A HREF="#WriteAt()">WriteAt()</A></TT></B> is implemented by derived classes to copy <I><FONT  color=991122 face=HELVETICA>numBytes</I></FONT> bytes of data from the <I><FONT  color=991122 face=HELVETICA>buffer</I></FONT> to the <I><FONT  color=991122 face=HELVETICA>position</I></FONT> offset in the object's data repository.  Like <B><TT><A HREF="#Write()">Write()</A></TT></B> it should return the number of bytes it succeeds in writing, or an error code.
<P>
The BPositionIO class implements <B><TT><A HREF="#Write()">Write()</A></TT></B> in terms of <B><TT><A HREF="#WriteAt()">WriteAt()</A></TT></B>, <B><TT><A HREF="#Seek()">Seek()</A></TT></B>,  and <B><TT><A HREF="#Position()">Position()</A></TT></B>&mdash;so that it always writes to the current position and moves the position marker past the data it has written.
<P>
</PRE></TABLE></UL></MENU></B></I></TT>



<!--TOP LINKS-->
<HR>
<center>
<TABLE bgcolor=ddeeee>
<TR><TD>
<A HREF="index.html"><FONT face=HELVETICA>The Support Kit Table of Contents</FONT></A>&nbsp;&nbsp;
<TD>
&nbsp;&nbsp;<A HREF="The%20Support%20Kit%20Master%20Index.html"><FONT face=HELVETICA>The Support Kit Index</FONT></A>
</TABLE></center>
<!--TOP LINKS-->


<!-- Footer for Release 5 HTML Be Book -->
<hr>
<br>
<p>
<center>
<i><FONT size=6>T</FONT>he <FONT size=6 color=blue>B</FONT><FONT size=6 color=red>e</font> <FONT size=6>B</FONT>ook</i>,
<br>...in lovely HTML...
<br>for BeOS Release 5.
<center>
<br>
<p><font face=helvetiva>Copyright &copy; 2000 Be, Inc.  All rights reserved..
</body>
</html>

